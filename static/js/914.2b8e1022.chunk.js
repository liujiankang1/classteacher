"use strict";(self.webpackChunkfrontend_react=self.webpackChunkfrontend_react||[]).push([[914],{21586:(e,t,a)=>{a.d(t,{A6:()=>c,LP:()=>x,Qu:()=>m,Rj:()=>r,Y:()=>n,dp:()=>d,ne:()=>l,s5:()=>o,w_:()=>i});const s=a(79722).A.create({baseURL:"http://124.70.74.246:8081",timeout:3e4,headers:{"Content-Type":"application/json"}});s.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),(e=>Promise.reject(e)));const n=async()=>await s.get("/api/students"),r=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;return console.log("\u5f00\u59cb\u83b7\u53d6\u5b66\u751f\u5206\u9875\u6570\u636e\uff0c\u76f4\u63a5\u8bf7\u6c42\u540e\u7aef"),await s.get("/api/students/paged?page=".concat(e,"&size=").concat(t))},c=async e=>await s.get("/api/students/class/".concat(e)),l=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return await s.get("/api/students/class/".concat(e,"/paged?page=").concat(t,"&size=").concat(a))},i=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;return await s.get("/api/students/search/paged?name=".concat(e,"&page=").concat(t,"&size=").concat(a))},o=async e=>await s.post("/api/students",e),d=async(e,t)=>await s.put("/api/students/".concat(e),t),x=async e=>await s.delete("/api/students/".concat(e)),m=async e=>await s.post("/api/students/batch",e,{headers:{"Content-Type":"multipart/form-data"}})},83914:(e,t,a)=>{a.r(t),a.d(t,{default:()=>X});var s=a(89379),n=a(80045),r=a(65043),c=a(53969),l=a(94799),i=a(55895),o=a(83759),d=a(28259),x=a(87443),m=a(10756),h=a(86172),u=a(81341),p=a(34375),g=a(10256),j=a(3353),A=a(67203),b=a(47471),y=a(14333),f=a(12843),v=a(91244),S=a(16128),w=a(57994),I=a(24343),N=a(12097),E=a(80172),z=a(70298),k=a(70916),C=a(91449),R=a(29066),L=a(98512);const O=a(79722).A.create({baseURL:"http://124.70.74.246:8081",timeout:3e4,headers:{"Content-Type":"application/json"}});O.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),(e=>Promise.reject(e)));var T=a(21586),B=a(2444),W=a(34515),F=a(38295),D=a(93557),P=a(59245),H=a(14023),_=a(38084),G=a(23894),Y=a(99869),M=a(82860),q=a(34113),Q=a(70579);B.Y([F.a,D.a,P.a,Y.a,q.a,M.i,H.a,_.a,G.a]);const U=e=>{let{data:t,subjectNames:a,loading:s=!1,height:n=400,title:o="\u5b66\u751f\u6210\u7ee9\u8d8b\u52bf"}=e;const d=(0,r.useRef)(null),x=(0,r.useRef)(null);return(0,r.useEffect)((()=>{if(s||!t||0===Object.keys(t).length)return;if(!d.current)return;x.current||(x.current=W.Ts(d.current));const e=[],n=[],r=Object.keys(t),c=new Map;r.forEach((e=>{t[e].forEach((e=>{c.has("".concat(e.examId))||c.set("".concat(e.examId),{name:e.examName,date:e.examDate,index:c.size})}))}));const l=Array.from(c.entries()).sort(((e,t)=>{const a=new Date(e[1].date).getTime(),s=new Date(t[1].date).getTime();return a!==s?a-s:e[1].index-t[1].index}));l.forEach((e=>{n.push(e[1].name)})),r.forEach((s=>{const n=t[s],r=new Map;n.forEach((e=>{r.set("".concat(e.examId),{value:e.score,fullScore:e.fullScore,examDate:e.examDate,rank:e.rank,totalStudents:e.totalStudents,examName:e.examName})}));const c=l.map((e=>{const t=e[0],a=r.get(t);return a||{value:null,fullScore:null,examDate:e[1].date,examName:e[1].name}})),i=a[s]||"\u79d1\u76ee".concat(s);e.push({name:i,type:"line",data:c,smooth:!0,symbol:"circle",symbolSize:8,lineStyle:{width:3},itemStyle:{borderWidth:2},label:{show:!0,position:"top",formatter:function(e){return null===e.value?"":e.value},fontSize:12,color:"#333"},connectNulls:!0,emphasis:{itemStyle:{borderWidth:3,shadowBlur:10,shadowColor:"rgba(0, 0, 0, 0.3)"},label:{fontSize:14,fontWeight:"bold"}}})}));const i={title:{text:o,left:"center"},tooltip:{trigger:"axis",formatter:function(e){if(0===e.length)return"";const t=e[0].dataIndex,a=n[t];let s='<div style="font-weight:bold;margin-bottom:5px">'.concat(a,"</div>");return e.forEach((e=>{if(null===e.value)return;const{fullScore:t,rank:a,totalStudents:n}=e.data;if(!t)return;const r=(e.value/t*100).toFixed(2);s+='<div style="margin: 3px 0">'.concat(e.seriesName,': <span style="font-weight:bold;color:').concat(e.color,'">').concat(e.value,"</span> / ").concat(t," (").concat(r,"%)</div>"),a&&n&&(s+='<div style="margin-left:15px">\u6392\u540d: '.concat(a," / ").concat(n,"</div>"))})),s}},legend:{type:"scroll",orient:"horizontal",bottom:30,data:r.map((e=>a[e]||"\u79d1\u76ee".concat(e)))},toolbox:{feature:{saveAsImage:{title:"\u4fdd\u5b58\u4e3a\u56fe\u7247"}}},grid:{left:"3%",right:"4%",bottom:"15%",top:"15%",containLabel:!0},dataZoom:[{type:"slider",show:n.length>5,bottom:5,height:20,start:0,end:n.length<=5?100:80}],xAxis:{type:"category",boundaryGap:!0,data:n,axisLabel:{rotate:30,fontSize:12,interval:0}},yAxis:{type:"value",name:"\u5206\u6570",nameLocation:"middle",nameGap:40,min:0,max:function(e){return Math.max(100,10*Math.ceil(e.max/10))}},series:e};x.current.setOption(i);const m=()=>{var e;null===(e=x.current)||void 0===e||e.resize()};return window.addEventListener("resize",m),()=>{window.removeEventListener("resize",m)}}),[t,s,a,o]),(0,Q.jsxs)(c.A,{sx:{width:"100%",position:"relative"},children:[s&&(0,Q.jsx)(c.A,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(255, 255, 255, 0.7)",zIndex:1},children:(0,Q.jsx)(E.A,{})}),!t||0===Object.keys(t).length&&!s?(0,Q.jsx)(l.A,{sx:{height:n,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f5f5f5"},children:(0,Q.jsx)(i.A,{variant:"body1",color:"textSecondary",children:"\u6682\u65e0\u6570\u636e"})}):(0,Q.jsx)(c.A,{ref:d,sx:{width:"100%",height:n}})]})};var J=a(48210);B.Y([F.a,D.a,P.a,J.a,q.a,M.i,H.a,_.a]);const $=e=>{let{data:t,totalStats:a,loading:s=!1,height:n=400,title:o="\u73ed\u7ea7\u6210\u7ee9\u5bf9\u6bd4",showType:d="both",scoreType:x="total"}=e;const m=(0,r.useRef)(null),h=(0,r.useRef)(null);return(0,r.useEffect)((()=>{if(s||!t||0===Object.keys(t).length)return;if(!m.current)return;h.current||(h.current=W.Ts(m.current));const e=Object.keys(t),n=e.map((e=>t[e].subjectName));a&&n.push("\u603b\u5206");const r=e.map((e=>t[e].avgScore)),c=e.map((e=>t[e].maxScore)),l=e.map((e=>t[e].minScore)),i=e.map((e=>(100*t[e].passRate).toFixed(2))),u=e.map((e=>(100*t[e].excellentRate).toFixed(2)));a&&(r.push(a.avgScore),c.push(a.maxScore),l.push(a.minScore),i.push((100*a.passRate).toFixed(2)),u.push((100*a.excellentRate).toFixed(2)));const p={title:{text:"".concat(o," - ").concat("total"===x?"\u603b\u5206":"\u5e73\u5747\u5206","\u7edf\u8ba1"),left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(e){const t=e[0].name;let a='<div style="font-weight:bold;margin-bottom:5px">'.concat(t,"</div>");return e.forEach((e=>{a+='<div style="margin: 3px 0">'.concat(e.seriesName,': <span style="font-weight:bold;color:').concat(e.color,'">').concat(e.value,"</span></div>")})),a}},legend:{data:"total"===x?["\u5e73\u5747\u5206","\u6700\u9ad8\u5206","\u6700\u4f4e\u5206"]:["\u5e73\u5747\u5206"],bottom:10},toolbox:{feature:{saveAsImage:{title:"\u4fdd\u5b58\u4e3a\u56fe\u7247"}}},grid:{left:"3%",right:"4%",bottom:"15%",top:"15%",containLabel:!0},xAxis:{type:"category",data:n,axisLabel:{rotate:30,fontSize:12}},yAxis:{type:"value",name:"\u5206\u6570",nameLocation:"middle",nameGap:40},series:"total"===x?[{name:"\u5e73\u5747\u5206",type:"bar",data:r,itemStyle:{color:"#5470c6"}},{name:"\u6700\u9ad8\u5206",type:"bar",data:c,itemStyle:{color:"#91cc75"}},{name:"\u6700\u4f4e\u5206",type:"bar",data:l,itemStyle:{color:"#ee6666"}}]:[{name:"\u5e73\u5747\u5206",type:"bar",data:r,itemStyle:{color:"#5470c6"}}]},g={title:{text:"".concat(o," - \u6bd4\u7387\u7edf\u8ba1"),left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(e){const t=e[0].name;let a='<div style="font-weight:bold;margin-bottom:5px">'.concat(t,"</div>");return e.forEach((e=>{a+='<div style="margin: 3px 0">'.concat(e.seriesName,': <span style="font-weight:bold;color:').concat(e.color,'">').concat(e.value,"%</span></div>")})),a}},legend:{data:["\u53ca\u683c\u7387","\u4f18\u79c0\u7387"],bottom:10},toolbox:{feature:{saveAsImage:{title:"\u4fdd\u5b58\u4e3a\u56fe\u7247"}}},grid:{left:"3%",right:"4%",bottom:"15%",top:"15%",containLabel:!0},xAxis:{type:"category",data:n,axisLabel:{rotate:30,fontSize:12}},yAxis:{type:"value",name:"\u767e\u5206\u6bd4",nameLocation:"middle",nameGap:40,min:0,max:100,axisLabel:{formatter:"{value}%"}},series:[{name:"\u53ca\u683c\u7387",type:"bar",data:i,itemStyle:{color:"#5470c6"}},{name:"\u4f18\u79c0\u7387",type:"bar",data:u,itemStyle:{color:"#91cc75"}}]};let j;j="score"===d?p:"rate"===d?g:{title:[{text:"".concat(o," - ").concat("total"===x?"\u603b\u5206":"\u5e73\u5747\u5206","\u7edf\u8ba1"),left:"center",top:"5%"},{text:"".concat(o," - \u6bd4\u7387\u7edf\u8ba1"),left:"center",top:"55%"}],tooltip:[{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(e){const t=e[0].name;let a='<div style="font-weight:bold;margin-bottom:5px">'.concat(t,"</div>");return e.forEach((e=>{a+='<div style="margin: 3px 0">'.concat(e.seriesName,': <span style="font-weight:bold;color:').concat(e.color,'">').concat(e.value,"</span></div>")})),a}},{trigger:"axis",axisPointer:{type:"shadow"},formatter:function(e){const t=e[0].name;let a='<div style="font-weight:bold;margin-bottom:5px">'.concat(t,"</div>");return e.forEach((e=>{a+='<div style="margin: 3px 0">'.concat(e.seriesName,': <span style="font-weight:bold;color:').concat(e.color,'">').concat(e.value,"%</span></div>")})),a}}],grid:[{left:"3%",right:"4%",top:"15%",height:"30%",containLabel:!0},{left:"3%",right:"4%",top:"65%",height:"30%",containLabel:!0}],xAxis:[{type:"category",data:n,gridIndex:0,axisLabel:{rotate:30,fontSize:12}},{type:"category",data:n,gridIndex:1,axisLabel:{rotate:30,fontSize:12}}],yAxis:[{type:"value",name:"\u5206\u6570",nameLocation:"middle",nameGap:40,gridIndex:0},{type:"value",name:"\u767e\u5206\u6bd4",nameLocation:"middle",nameGap:40,min:0,max:100,axisLabel:{formatter:"{value}%"},gridIndex:1}],legend:[{data:"total"===x?["\u5e73\u5747\u5206","\u6700\u9ad8\u5206","\u6700\u4f4e\u5206"]:["\u5e73\u5747\u5206"],bottom:"40%"},{data:["\u53ca\u683c\u7387","\u4f18\u79c0\u7387"],bottom:"0%"}],toolbox:{feature:{saveAsImage:{title:"\u4fdd\u5b58\u4e3a\u56fe\u7247"}}},series:"total"===x?[{name:"\u5e73\u5747\u5206",type:"bar",data:r,itemStyle:{color:"#5470c6"},xAxisIndex:0,yAxisIndex:0},{name:"\u6700\u9ad8\u5206",type:"bar",data:c,itemStyle:{color:"#91cc75"},xAxisIndex:0,yAxisIndex:0},{name:"\u6700\u4f4e\u5206",type:"bar",data:l,itemStyle:{color:"#ee6666"},xAxisIndex:0,yAxisIndex:0},{name:"\u53ca\u683c\u7387",type:"bar",data:i,itemStyle:{color:"#5470c6"},xAxisIndex:1,yAxisIndex:1},{name:"\u4f18\u79c0\u7387",type:"bar",data:u,itemStyle:{color:"#91cc75"},xAxisIndex:1,yAxisIndex:1}]:[{name:"\u5e73\u5747\u5206",type:"bar",data:r,itemStyle:{color:"#5470c6"},xAxisIndex:0,yAxisIndex:0},{name:"\u53ca\u683c\u7387",type:"bar",data:i,itemStyle:{color:"#5470c6"},xAxisIndex:1,yAxisIndex:1},{name:"\u4f18\u79c0\u7387",type:"bar",data:u,itemStyle:{color:"#91cc75"},xAxisIndex:1,yAxisIndex:1}]},h.current.setOption(j);const A=()=>{var e;null===(e=h.current)||void 0===e||e.resize()};return window.addEventListener("resize",A),()=>{window.removeEventListener("resize",A)}}),[t,s,o,d,x,a]),(0,Q.jsxs)(c.A,{sx:{width:"100%",position:"relative"},children:[s&&(0,Q.jsx)(c.A,{sx:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"rgba(255, 255, 255, 0.7)",zIndex:1},children:(0,Q.jsx)(E.A,{})}),!t||0===Object.keys(t).length&&!s?(0,Q.jsx)(l.A,{sx:{height:n,display:"flex",alignItems:"center",justifyContent:"center",backgroundColor:"#f5f5f5"},children:(0,Q.jsx)(i.A,{variant:"body1",color:"textSecondary",children:"\u6682\u65e0\u6570\u636e"})}):(0,Q.jsx)(c.A,{ref:m,sx:{width:"100%",height:n}})]})},Z=["children","value","index"];function K(e){const{children:t,value:a,index:r}=e,l=(0,n.A)(e,Z);return(0,Q.jsx)("div",(0,s.A)((0,s.A)({role:"tabpanel",hidden:a!==r,id:"statistics-tabpanel-".concat(r),"aria-labelledby":"statistics-tab-".concat(r)},l),{},{style:{marginTop:"16px"},children:a===r&&(0,Q.jsx)(c.A,{sx:{p:3},children:t})}))}function V(e){return{id:"statistics-tab-".concat(e),"aria-controls":"statistics-tabpanel-".concat(e)}}const X=()=>{const{user:e}=(0,R.As)(),[t,a]=(0,r.useState)([]),[n,B]=(0,r.useState)(""),[W,F]=(0,r.useState)(""),[D,P]=(0,r.useState)([]),[H,_]=(0,r.useState)([]),[G,Y]=(0,r.useState)([]),[M,q]=(0,r.useState)(!1),[J,Z]=(0,r.useState)(0),[X,ee]=(0,r.useState)([]),[te,ae]=(0,r.useState)(null),[se,ne]=(0,r.useState)("total"),[re,ce]=(0,r.useState)({}),[le,ie]=(0,r.useState)({open:!1,message:"",severity:"info"}),oe=async t=>{try{let a;a=t?await T.A6(t):e&&"ROLE_HEADTEACHER"===e.role&&e.classId?await T.A6(e.classId):await T.Y(),a.data&&_(a.data.content||a.data)}catch(a){console.error("\u83b7\u53d6\u5b66\u751f\u5217\u8868\u5931\u8d25:",a)}},de=async()=>{if(0!==G.length){q(!0);try{const e=G.map((e=>(async(e,t,a)=>{const s={studentId:e};return t&&(s.subjectId=t),a&&a.length>0&&(s.examIds=a.join(",")),console.log("\u83b7\u53d6\u5b66\u751f\u6210\u7ee9\u8d8b\u52bf\uff0c\u76f4\u63a5\u8bf7\u6c42\u540e\u7aef"),O.get("/api/statistics/student/trend",{params:s})})(e.id,W?Number(W):void 0,n&&""!==n?[Number(n)]:void 0))),t=(await Promise.all(e)).map((e=>e.data)).filter(Boolean);ee(t)}catch(e){console.error("\u83b7\u53d6\u5b66\u751f\u6210\u7ee9\u8d8b\u52bf\u5931\u8d25:",e),ge("\u83b7\u53d6\u5b66\u751f\u6210\u7ee9\u8d8b\u52bf\u5931\u8d25","error")}finally{q(!1)}}else ge("\u8bf7\u81f3\u5c11\u9009\u62e9\u4e00\u540d\u5b66\u751f","warning")},xe=async()=>{if(!n)return void ge("\u8bf7\u5148\u9009\u62e9\u8003\u8bd5","warning");let a;if(e&&"ROLE_HEADTEACHER"===e.role&&e.classId)a=e.classId;else{const e=t.find((e=>e.id===Number(n)));e&&e.classId&&(a=e.classId)}if(a){q(!0);try{const e=await(async(e,t,a)=>{const s={classId:e};return t&&(s.examId=t),a&&(s.subjectId=a),O.get("/api/statistics/class/comparison",{params:s})})(a,Number(n),W?Number(W):void 0);if(e.data){let t=JSON.parse(JSON.stringify(e.data));const a={};try{t.subjectStats&&Object.keys(t.subjectStats).forEach((e=>{const s=String(e);t.scoreRanges&&t.scoreRanges[s]?a[s]=Array.isArray(t.scoreRanges[s])?[...t.scoreRanges[s]]:[]:a[s]=[]}))}catch(s){console.error("\u5206\u6570\u6bb5\u6570\u636e\u5904\u7406\u9519\u8bef:",s)}ce(a),t.scoreRanges||(t.scoreRanges={}),ae(t),t.subjectStats&&Object.keys(t.subjectStats).length>0&&ne(Object.keys(t.subjectStats)[0])}}catch(r){console.error("\u83b7\u53d6\u73ed\u7ea7\u6210\u7ee9\u5bf9\u6bd4\u5931\u8d25:",r),ge("\u83b7\u53d6\u73ed\u7ea7\u6210\u7ee9\u5bf9\u6bd4\u5931\u8d25","error")}finally{q(!1)}}else ge("\u65e0\u6cd5\u786e\u5b9a\u73ed\u7ea7\u4fe1\u606f","warning")},me=a=>{const s=a.target.value;if(B(s),F(""),s&&""!==s){(async e=>{q(!0);try{const t=await L.I$(e);if(t.data&&t.data.examSubjects){const e=t.data.examSubjects.map((e=>({id:e.subject.id,name:e.subjectName||e.subject.name,fullScore:e.fullScore})));P(e)}}catch(t){console.error("\u83b7\u53d6\u79d1\u76ee\u5217\u8868\u5931\u8d25:",t),ge("\u83b7\u53d6\u79d1\u76ee\u5217\u8868\u5931\u8d25","error")}finally{q(!1)}})(Number(s));const e=t.find((e=>e.id===Number(s)));e&&e.classId&&oe(e.classId)}else P([]),e&&"ROLE_HEADTEACHER"===e.role&&e.classId?oe(e.classId):oe()},he=e=>{F(e.target.value)},ue=e=>{const t=e.target.value;ne(""),setTimeout((()=>{ne(t)}),0)},pe=()=>{0===J?de():1===J&&xe()},ge=function(e){ie({open:!0,message:e,severity:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info"})},je=()=>{ie((e=>(0,s.A)((0,s.A)({},e),{},{open:!1})))};(0,r.useEffect)((()=>{e&&"ROLE_HEADTEACHER"===e.role&&e.classId?oe(e.classId):oe()}),[e]),(0,r.useEffect)((()=>{(async()=>{q(!0);try{const e=await L.Qg();if(e.data&&Array.isArray(e.data)){const t=e.data.map((e=>{var t,a;return{id:e.id,name:e.examName||e.name,examDate:e.examDate,className:null===(t=e.classInfo)||void 0===t?void 0:t.className,classId:null===(a=e.classInfo)||void 0===a?void 0:a.id}}));a(t)}}catch(e){console.error("\u83b7\u53d6\u8003\u8bd5\u5217\u8868\u5931\u8d25:",e),ge("\u83b7\u53d6\u8003\u8bd5\u5217\u8868\u5931\u8d25","error")}finally{q(!1)}})()}),[]);const Ae=()=>{if(!X.length)return[];const e=new Set,t=new Set,a={};X.forEach(((s,n)=>{Object.keys(s.trends).forEach((r=>{if("total"===r)return;const c=s.subjects.find((e=>e.id.toString()===r)),l=c?c.name:"\u79d1\u76ee".concat(r);s.trends[r].forEach((s=>{const c="".concat(s.examId,"-").concat(s.examName),i="".concat(r,"-").concat(l);e.add(c),t.add(i),a[c]||(a[c]={}),a[c][i]||(a[c][i]=Array(X.length).fill(null).map((()=>({})))),a[c][i][n]={score:s.score,fullScore:s.fullScore,rank:s.rank,totalStudents:s.totalStudents}}))}))}));const s=[],n=Array.from(e).sort(),r=Array.from(t).sort();return n.forEach((e=>{const[,t]=e.split("-");r.forEach((n=>{if("total"===n)return;let[,r]=n.split("-");a[e]&&a[e][n]&&s.push({examName:t,subjectName:r,scores:a[e][n]})}))})),s};return(0,Q.jsxs)(c.A,{children:[(0,Q.jsx)(i.A,{variant:"h5",component:"h1",sx:{mb:3},children:"\u6210\u7ee9\u7edf\u8ba1"}),(0,Q.jsx)(c.A,{sx:{borderBottom:1,borderColor:"divider"},children:(0,Q.jsxs)(y.A,{value:J,onChange:(e,t)=>{Z(t),0===t?ee([]):1===t&&ae(null)},"aria-label":"\u7edf\u8ba1\u5206\u6790\u9009\u9879\u5361",children:[(0,Q.jsx)(f.A,(0,s.A)({label:"\u5b66\u751f\u4e2a\u4eba\u6210\u7ee9\u8d8b\u52bf"},V(0))),(0,Q.jsx)(f.A,(0,s.A)({label:"\u73ed\u7ea7\u8003\u8bd5\u6210\u7ee9\u5bf9\u6bd4"},V(1)))]})}),(0,Q.jsxs)(K,{value:J,index:0,children:[(0,Q.jsx)(v.A,{sx:{mb:3},children:(0,Q.jsx)(S.A,{children:(0,Q.jsxs)(c.A,{sx:{display:"flex",flexWrap:"wrap",gap:2},children:[(0,Q.jsx)(c.A,{sx:{flexBasis:{xs:"100%",sm:"23%"}},children:(0,Q.jsxs)(g.A,{fullWidth:!0,size:"small",children:[(0,Q.jsx)(j.A,{id:"exam-select-label",children:"\u9009\u62e9\u8003\u8bd5"}),(0,Q.jsxs)(A.A,{labelId:"exam-select-label",id:"exam-select",value:n,label:"\u9009\u62e9\u8003\u8bd5",onChange:me,children:[(0,Q.jsx)(b.A,{value:"",children:(0,Q.jsx)("em",{children:"\u6240\u6709\u8003\u8bd5"})}),t.map((e=>(0,Q.jsxs)(b.A,{value:e.id,children:[e.name," ",e.className?"(".concat(e.className,")"):""]},e.id)))]})]})}),(0,Q.jsx)(c.A,{sx:{flexBasis:{xs:"100%",sm:"23%"}},children:(0,Q.jsxs)(g.A,{fullWidth:!0,size:"small",disabled:!n||0===D.length,children:[(0,Q.jsx)(j.A,{id:"subject-select-label",children:"\u9009\u62e9\u79d1\u76ee"}),(0,Q.jsxs)(A.A,{labelId:"subject-select-label",id:"subject-select",value:W,label:"\u9009\u62e9\u79d1\u76ee",onChange:he,children:[(0,Q.jsx)(b.A,{value:"",children:(0,Q.jsx)("em",{children:"\u6240\u6709\u79d1\u76ee"})}),D.map((e=>(0,Q.jsx)(b.A,{value:e.id,children:e.name},e.id)))]})]})}),(0,Q.jsx)(c.A,{sx:{flexBasis:{xs:"100%",sm:"23%"}},children:(0,Q.jsx)(w.A,{multiple:!0,id:"students-select",options:H,getOptionLabel:e=>"".concat(e.name," (").concat(e.studentNumber,")"),value:G,onChange:(e,t)=>{t.length>2?ge("\u6700\u591a\u53ea\u80fd\u9009\u62e9\u4e24\u540d\u5b66\u751f\u8fdb\u884c\u5bf9\u6bd4","warning"):Y(t)},renderInput:e=>(0,Q.jsx)(I.A,(0,s.A)((0,s.A)({},e),{},{label:"\u9009\u62e9\u5b66\u751f(\u6700\u591a2\u540d)",size:"small"})),renderOption:(e,t)=>(0,Q.jsxs)("li",(0,s.A)((0,s.A)({},e),{},{children:[t.name," (",t.studentNumber,")",t.className&&(0,Q.jsx)(o.A,{label:t.className,size:"small",sx:{ml:1}})]})),renderTags:(e,t)=>e.map(((e,a)=>(0,r.createElement)(o.A,(0,s.A)((0,s.A)({},t({index:a})),{},{key:a,label:"".concat(e.name," (").concat(e.studentNumber,")"),size:"small"}))))})}),(0,Q.jsx)(c.A,{sx:{flexBasis:{xs:"100%",sm:"23%"}},children:(0,Q.jsx)(N.A,{variant:"contained",color:"primary",fullWidth:!0,disabled:M,onClick:pe,children:M?(0,Q.jsx)(E.A,{size:24}):"\u67e5\u8be2"})})]})})}),(0,Q.jsx)(l.A,{sx:{p:3},children:X.length>0?(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsxs)(z.A,{direction:"row",spacing:2,alignItems:"center",sx:{mb:3},children:[(0,Q.jsx)(i.A,{variant:"h6",children:"\u5b66\u751f\u6210\u7ee9\u8d8b\u52bf\u5bf9\u6bd4"}),(0,Q.jsx)(o.A,{label:"\u5df2\u9009\u62e9 ".concat(X.length," \u540d\u5b66\u751f"),color:"primary"})]}),X.length?(0,Q.jsxs)(c.A,{children:[(0,Q.jsx)(c.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:X.map(((e,t)=>{const a={},s={};if(W&&""!==W){const t=W.toString();if(e.trends[t]){a[t]=e.trends[t];const n=e.subjects.find((e=>e.id.toString()===t));s[t]=n?n.name:"\u79d1\u76ee".concat(t)}}else e.subjects.forEach((t=>{const n=t.id.toString();e.trends[n]&&(a[n]=e.trends[n],s[n]=t.name)}));return(0,Q.jsx)(c.A,{sx:{width:"100%"},children:(0,Q.jsxs)(l.A,{sx:{p:2,mb:2},children:[(0,Q.jsxs)(i.A,{variant:"h6",gutterBottom:!0,children:[e.student.name," (",e.student.studentNumber,")",e.student.className&&(0,Q.jsx)(o.A,{label:e.student.className,size:"small",color:"primary",sx:{ml:1}})]}),(0,Q.jsx)(U,{data:a,subjectNames:s,loading:M,height:350,title:"".concat(e.student.name," - \u6210\u7ee9\u8d8b\u52bf")})]})},t)}))}),(0,Q.jsxs)(l.A,{sx:{p:2,mt:2},children:[(0,Q.jsx)(i.A,{variant:"h6",gutterBottom:!0,children:"\u6210\u7ee9\u5217\u8868"}),(0,Q.jsx)(d.A,{children:(0,Q.jsxs)(x.A,{size:"small",children:[(0,Q.jsx)(m.A,{children:(0,Q.jsxs)(h.A,{children:[(0,Q.jsx)(u.A,{children:"\u8003\u8bd5"}),(0,Q.jsx)(u.A,{children:"\u79d1\u76ee"}),X.map(((e,t)=>(0,Q.jsxs)(u.A,{children:[e.student.name," (",e.student.studentNumber,")"]},t)))]})}),(0,Q.jsx)(p.A,{children:Ae().map(((e,t)=>(0,Q.jsxs)(h.A,{hover:!0,children:[(0,Q.jsx)(u.A,{children:e.examName}),(0,Q.jsx)(u.A,{children:e.subjectName}),e.scores.map(((e,t)=>(0,Q.jsx)(u.A,{children:void 0!==e.score?(0,Q.jsxs)(c.A,{children:[(0,Q.jsx)(i.A,{variant:"body2",fontWeight:"bold",children:e.score}),e.rank&&e.totalStudents&&(0,Q.jsxs)(i.A,{variant:"caption",color:"textSecondary",children:["\u6392\u540d: ",e.rank,"/",e.totalStudents]})]}):"-"},t)))]},t)))})]})})]})]}):null]}):(0,Q.jsx)(c.A,{sx:{textAlign:"center",py:10},children:(0,Q.jsx)(i.A,{variant:"body1",color:"textSecondary",children:"\u8bf7\u9009\u62e9\u5b66\u751f\u5e76\u70b9\u51fb\u67e5\u8be2\u6309\u94ae\u67e5\u770b\u6210\u7ee9\u8d8b\u52bf"})})})]}),(0,Q.jsxs)(K,{value:J,index:1,children:[(0,Q.jsx)(v.A,{sx:{mb:3},children:(0,Q.jsx)(S.A,{children:(0,Q.jsxs)(c.A,{sx:{display:"flex",flexWrap:"wrap",gap:2},children:[(0,Q.jsx)(c.A,{sx:{flexBasis:{xs:"100%",sm:"45%"}},children:(0,Q.jsxs)(g.A,{fullWidth:!0,size:"small",children:[(0,Q.jsx)(j.A,{id:"exam-select-label",children:"\u9009\u62e9\u8003\u8bd5"}),(0,Q.jsxs)(A.A,{labelId:"exam-select-label",id:"exam-select",value:n,label:"\u9009\u62e9\u8003\u8bd5",onChange:me,children:[(0,Q.jsx)(b.A,{value:"",children:(0,Q.jsx)("em",{children:"\u6240\u6709\u8003\u8bd5"})}),t.map((e=>(0,Q.jsxs)(b.A,{value:e.id,children:[e.name," ",e.className?"(".concat(e.className,")"):""]},e.id)))]})]})}),(0,Q.jsx)(c.A,{sx:{flexBasis:{xs:"100%",sm:"45%"}},children:(0,Q.jsxs)(g.A,{fullWidth:!0,size:"small",disabled:!n||0===D.length,children:[(0,Q.jsx)(j.A,{id:"subject-select-label",children:"\u9009\u62e9\u79d1\u76ee"}),(0,Q.jsxs)(A.A,{labelId:"subject-select-label",id:"subject-select",value:W,label:"\u9009\u62e9\u79d1\u76ee",onChange:he,children:[(0,Q.jsx)(b.A,{value:"",children:(0,Q.jsx)("em",{children:"\u6240\u6709\u79d1\u76ee"})}),D.map((e=>(0,Q.jsx)(b.A,{value:e.id,children:e.name},e.id)))]})]})}),(0,Q.jsx)(c.A,{sx:{flexBasis:{xs:"100%",sm:"100%"},display:"flex",justifyContent:"flex-end"},children:(0,Q.jsx)(N.A,{variant:"contained",color:"primary",disabled:M,onClick:pe,sx:{minWidth:"120px"},children:M?(0,Q.jsx)(E.A,{size:24}):"\u67e5\u8be2"})})]})})}),(0,Q.jsx)(l.A,{sx:{p:3},children:te?(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)(z.A,{direction:"row",spacing:2,alignItems:"center",sx:{mb:3},children:(0,Q.jsxs)(i.A,{variant:"h6",children:[te.className," - ",te.exam.name," \u6210\u7ee9\u5bf9\u6bd4"]})}),(()=>{var e;if(!te)return null;const t={};if(W&&""!==W){const e=W.toString(),a=te.subjectStats[e];a&&(t[e]=a)}else Object.keys(te.subjectStats).forEach((e=>{t[e]=te.subjectStats[e]}));return(0,Q.jsxs)(Q.Fragment,{children:[(0,Q.jsx)($,{data:t,totalStats:te.totalStats,loading:M,height:500,title:"".concat(te.className," - ").concat(te.exam.name," - \u6210\u7ee9\u5bf9\u6bd4"),showType:"score",scoreType:"total"}),(0,Q.jsxs)(l.A,{sx:{p:2,mt:3},children:[(0,Q.jsx)(i.A,{variant:"h6",gutterBottom:!0,children:"\u73ed\u7ea7\u6210\u7ee9\u8be6\u60c5"}),(0,Q.jsx)(d.A,{children:(0,Q.jsxs)(x.A,{size:"small",children:[(0,Q.jsx)(m.A,{children:(0,Q.jsxs)(h.A,{children:[(0,Q.jsx)(u.A,{children:"\u79d1\u76ee"}),(0,Q.jsx)(u.A,{align:"center",children:"\u5e73\u5747\u5206"}),(0,Q.jsx)(u.A,{align:"center",children:"\u6700\u9ad8\u5206"}),(0,Q.jsx)(u.A,{align:"center",children:"\u6700\u4f4e\u5206"}),(0,Q.jsx)(u.A,{align:"center",children:"\u53ca\u683c\u7387"}),(0,Q.jsx)(u.A,{align:"center",children:"\u4f18\u79c0\u7387"}),(0,Q.jsx)(u.A,{align:"center",children:"\u6ee1\u5206"})]})}),(0,Q.jsxs)(p.A,{children:[Object.keys(te.subjectStats).map((e=>{const t=te.subjectStats[e];return(0,Q.jsxs)(h.A,{hover:!0,children:[(0,Q.jsx)(u.A,{children:t.subjectName}),(0,Q.jsx)(u.A,{align:"center",children:t.avgScore.toFixed(2)}),(0,Q.jsx)(u.A,{align:"center",children:t.maxScore}),(0,Q.jsx)(u.A,{align:"center",children:t.minScore}),(0,Q.jsxs)(u.A,{align:"center",children:[(100*t.passRate).toFixed(2),"%"]}),(0,Q.jsxs)(u.A,{align:"center",children:[(100*t.excellentRate).toFixed(2),"%"]}),(0,Q.jsx)(u.A,{align:"center",children:t.fullScore})]},e)})),(0,Q.jsxs)(h.A,{sx:{backgroundColor:"rgba(0, 0, 0, 0.04)"},children:[(0,Q.jsx)(u.A,{sx:{fontWeight:"bold"},children:"\u603b\u5206"}),(0,Q.jsx)(u.A,{align:"center",sx:{fontWeight:"bold"},children:te.totalStats.avgScore.toFixed(2)}),(0,Q.jsx)(u.A,{align:"center",sx:{fontWeight:"bold"},children:te.totalStats.maxScore}),(0,Q.jsx)(u.A,{align:"center",sx:{fontWeight:"bold"},children:te.totalStats.minScore}),(0,Q.jsxs)(u.A,{align:"center",sx:{fontWeight:"bold"},children:[(100*te.totalStats.passRate).toFixed(2),"%"]}),(0,Q.jsxs)(u.A,{align:"center",sx:{fontWeight:"bold"},children:[(100*te.totalStats.excellentRate).toFixed(2),"%"]}),(0,Q.jsx)(u.A,{align:"center",children:"-"})]})]})]})})]}),(0,Q.jsxs)(l.A,{sx:{p:2,mt:3},children:[(0,Q.jsxs)(c.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,Q.jsx)(i.A,{variant:"h6",children:"\u5355\u79d1\u5206\u6570\u6bb5\u5206\u5e03"}),(0,Q.jsxs)(g.A,{size:"small",sx:{width:200},children:[(0,Q.jsx)(j.A,{id:"score-distribution-subject-label",children:"\u9009\u62e9\u79d1\u76ee"}),(0,Q.jsx)(A.A,{labelId:"score-distribution-subject-label",id:"score-distribution-subject",value:se,label:"\u9009\u62e9\u79d1\u76ee",onChange:ue,children:Object.keys(te.subjectStats).map((e=>(0,Q.jsx)(b.A,{value:e,children:te.subjectStats[e].subjectName},e)))})]})]}),(0,Q.jsx)(c.A,{sx:{mb:2,p:1,bgcolor:"primary.light",color:"white",borderRadius:1},children:(0,Q.jsxs)(i.A,{variant:"body2",children:["\u5f53\u524d\u9009\u62e9: ",(null===(e=te.subjectStats[se])||void 0===e?void 0:e.subjectName)||se,re[se]&&" (\u5171".concat(re[se].length,"\u4e2a\u5206\u6570\u6bb5)")]})}),re&&se&&re[se]&&Array.isArray(re[se])&&re[se].length>0?(0,Q.jsx)(d.A,{children:(0,Q.jsxs)(x.A,{size:"small",children:[(0,Q.jsx)(m.A,{children:(0,Q.jsxs)(h.A,{children:[(0,Q.jsx)(u.A,{width:"40%",children:"\u5206\u6570\u6bb5"}),(0,Q.jsx)(u.A,{align:"center",width:"30%",children:"\u4eba\u6570"}),(0,Q.jsx)(u.A,{align:"center",width:"30%",children:"\u5360\u6bd4"})]})}),(0,Q.jsx)(p.A,{children:re[se].map(((e,t)=>(0,Q.jsxs)(h.A,{hover:!0,children:[(0,Q.jsx)(u.A,{children:e.label||"\u672a\u547d\u540d"}),(0,Q.jsx)(u.A,{align:"center",children:e.count||0}),(0,Q.jsxs)(u.A,{align:"center",children:[(100*(e.percentage||0)).toFixed(2),"%"]})]},"range-".concat(se,"-").concat(t))))})]})}):(0,Q.jsx)(c.A,{sx:{py:3,textAlign:"center"},children:(0,Q.jsx)(i.A,{variant:"body1",color:"textSecondary",children:"\u6682\u65e0\u5206\u6570\u6bb5\u5206\u5e03\u6570\u636e"})})]})]})})()]}):(0,Q.jsx)(c.A,{sx:{textAlign:"center",py:10},children:(0,Q.jsx)(i.A,{variant:"body1",color:"textSecondary",children:"\u8bf7\u9009\u62e9\u8003\u8bd5\u5e76\u70b9\u51fb\u67e5\u8be2\u6309\u94ae\u67e5\u770b\u73ed\u7ea7\u6210\u7ee9\u5bf9\u6bd4"})})})]}),(0,Q.jsx)(k.A,{open:le.open,autoHideDuration:3e3,onClose:je,anchorOrigin:{vertical:"top",horizontal:"center"},children:(0,Q.jsx)(C.A,{onClose:je,severity:le.severity,variant:"filled",sx:{width:"100%"},children:le.message})})]})}},98512:(e,t,a)=>{a.d(t,{CB:()=>i,Dt:()=>d,FP:()=>o,I$:()=>r,Qg:()=>n,YB:()=>c,gg:()=>l,lu:()=>x});const s=a(79722).A.create({baseURL:"http://124.70.74.246:8081",timeout:3e4,headers:{"Content-Type":"application/json"}});s.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),(e=>Promise.reject(e)));const n=async()=>(console.log("\u83b7\u53d6\u6240\u6709\u8003\u8bd5\uff0c\u76f4\u63a5\u8bf7\u6c42\u540e\u7aef"),s.get("/api/exams")),r=async e=>s.get("/api/exams/".concat(e)),c=e=>s.get("/api/exams/class/".concat(e)),l=e=>s.get("/api/exams/status/".concat(e)),i=async e=>s.post("/api/exams",e),o=async(e,t)=>s.put("/api/exams/".concat(e),t),d=async e=>s.delete("/api/exams/".concat(e)),x=async(e,t)=>s.patch("/api/exams/".concat(e,"/status"),{status:t})}}]);
//# sourceMappingURL=914.2b8e1022.chunk.js.map