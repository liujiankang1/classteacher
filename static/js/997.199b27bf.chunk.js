"use strict";(self.webpackChunkfrontend_react=self.webpackChunkfrontend_react||[]).push([[997],{16128:(e,t,n)=>{n.d(t,{A:()=>A});var a=n(89379),r=n(80045),o=n(65043),i=n(58387),s=n(31807),l=n(58128),d=n(28301),c=n(79857),h=n(86061);function m(e){return(0,h.Ay)("MuiCardContent",e)}(0,c.A)("MuiCardContent",["root"]);var u=n(70579);const p=["className","component"],x=(0,l.Ay)("div",{name:"MuiCardContent",slot:"Root"})({padding:16,"&:last-child":{paddingBottom:24}}),A=o.forwardRef((function(e,t){const n=(0,d.b)({props:e,name:"MuiCardContent"}),{className:o,component:l="div"}=n,c=(0,r.A)(n,p),h=(0,a.A)((0,a.A)({},n),{},{component:l}),A=(e=>{const{classes:t}=e;return(0,s.A)({root:["root"]},m,t)})(h);return(0,u.jsx)(x,(0,a.A)({as:l,className:(0,i.A)(A.root,o),ownerState:h,ref:t},c))}))},22672:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(99992),r=n(70579);const o=(0,a.A)((0,r.jsx)("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3m3-10H5V5h10z"}),"Save")},49982:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(99992),r=n(70579);const o=(0,a.A)((0,r.jsx)("path",{d:"M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5s-3 1.34-3 3 1.34 3 3 3m-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5 5 6.34 5 8s1.34 3 3 3m0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5m8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5"}),"People")},61773:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(99992),r=n(70579);const o=(0,a.A)((0,r.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"Edit")},65979:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(99992),r=n(70579);const o=(0,a.A)((0,r.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M9 17H7v-7h2zm4 0h-2V7h2zm4 0h-2v-4h2z"}),"Assessment")},78997:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Y});var a=n(89379),r=n(65043),o=n(58128),i=n(91244),s=n(53969),l=n(24343),d=n(81341),c=n(42579),h=n(55895),m=n(53876),u=n(16128),p=n(12097),x=n(28259),A=n(87443),v=n(10756),j=n(86172),g=n(34375),f=n(26529),y=n(38517),C=n(81911),b=n(78776),w=n(85877),T=n(52956),S=n(70916),N=n(91449),z=n(49982),k=n(89685),M=n(65979),I=n(61773),R=n(22672),O=n(3260),V=n(29066);const W=n(79722).A.create({baseURL:"http://124.70.74.246:8081",timeout:3e4,headers:{"Content-Type":"application/json"}});W.interceptors.request.use((e=>{const t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),(e=>Promise.reject(e)));const J=async e=>{const t=JSON.stringify(e);return await W.post("/api/dashboard/schedule",{scheduleData:t})};var L=n(70579);const P=(0,o.Ay)(i.A)((e=>{let{theme:t}=e;return{borderRadius:"16px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",height:"100%",transition:"transform 0.3s, box-shadow 0.3s","&:hover":{transform:"translateY(-5px)",boxShadow:"0 8px 25px rgba(0, 0, 0, 0.15)"}}})),B=(0,o.Ay)(i.A)((e=>{let{theme:t}=e;return{borderRadius:"16px",boxShadow:"0 4px 20px rgba(0, 0, 0, 0.08)",marginTop:t.spacing(4),overflow:"visible"}})),H=(0,o.Ay)(s.A)((e=>{let{theme:t}=e;return{display:"flex",justifyContent:"space-between",alignItems:"center",padding:t.spacing(2,3),borderBottom:"1px solid ".concat(t.palette.divider)}})),U=(0,o.Ay)(l.A)((e=>{let{theme:t}=e;return{"& .MuiOutlinedInput-root":{"&:hover fieldset":{borderColor:t.palette.primary.main}}}})),D=(0,o.Ay)(d.A)((e=>{let{theme:t}=e;return{position:"relative",whiteSpace:"pre-line",minWidth:"150px",maxWidth:"150px",width:"150px"}})),E=(0,o.Ay)(c.A)((e=>{let{theme:t}=e;return{position:"absolute",top:"50%",transform:"translateY(-50%)",right:"24px",padding:"4px",opacity:.5,"&:hover":{opacity:1,backgroundColor:"rgba(0, 0, 0, 0.04)"}}})),Y=()=>{(0,O.Zp)();const{user:e}=(0,V.As)(),[t,n]=(0,r.useState)(!1),[o,i]=(0,r.useState)({teacherCount:0,studentCount:0,classCount:0}),[c,Y]=(0,r.useState)([]),[_,q]=(0,r.useState)([]),[Z,F]=(0,r.useState)(!1),[G,K]=(0,r.useState)(!1),[Q,X]=(0,r.useState)(null),[$,ee]=(0,r.useState)(null),te=[{label:"\u5468\u4e00",value:"monday"},{label:"\u5468\u4e8c",value:"tuesday"},{label:"\u5468\u4e09",value:"wednesday"},{label:"\u5468\u56db",value:"thursday"},{label:"\u5468\u4e94",value:"friday"}],ne=[{startTime:"08:00",endTime:"08:45",periodName:"\u7b2c\u4e00\u8282"},{startTime:"08:55",endTime:"09:40",periodName:"\u7b2c\u4e8c\u8282"},{startTime:"10:00",endTime:"10:45",periodName:"\u7b2c\u4e09\u8282"},{startTime:"10:55",endTime:"11:40",periodName:"\u7b2c\u56db\u8282"},{startTime:"14:00",endTime:"14:45",periodName:"\u7b2c\u4e94\u8282"},{startTime:"14:55",endTime:"15:40",periodName:"\u7b2c\u516d\u8282"},{startTime:"16:00",endTime:"16:45",periodName:"\u7b2c\u4e03\u8282"},{startTime:"16:55",endTime:"17:40",periodName:"\u7b2c\u516b\u8282"}],[ae,re]=(0,r.useState)({open:!1,message:"",severity:"info"}),oe=function(e){re({open:!0,message:e,severity:arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info"})},ie=()=>{re((e=>(0,a.A)((0,a.A)({},e),{},{open:!1})))},se=async()=>{try{n(!0);const e=await(async()=>(console.log("\u83b7\u53d6\u4eea\u8868\u76d8\u7edf\u8ba1\u6570\u636e\uff0c\u76f4\u63a5\u8bf7\u6c42\u540e\u7aef"),await W.get("/api/dashboard/statistics")))();e&&e.data&&i({teacherCount:e.data.teacherCount||0,studentCount:e.data.studentCount||0,classCount:e.data.classCount||0})}catch(e){console.error("\u83b7\u53d6\u7edf\u8ba1\u6570\u636e\u5931\u8d25:",e),i({teacherCount:0,studentCount:0,classCount:0})}finally{n(!1)}},le=async()=>{try{const t=await(async()=>(console.log("\u83b7\u53d6\u6559\u5e08\u8bfe\u7a0b\u8868\uff0c\u76f4\u63a5\u8bf7\u6c42\u540e\u7aef"),await W.get("/api/dashboard/schedule")))();if(t&&t.data&&t.data.scheduleData)try{const e=JSON.parse(t.data.scheduleData);Y(e.map(((e,t)=>{if(!e.startTime||!e.endTime){const n=ne[t]||{startTime:"00:00",endTime:"00:00",periodName:"\u7b2c".concat(t+1,"\u8282")},r=e.time.split("\n")[0].split("-");return(0,a.A)((0,a.A)({},e),{},{id:t+1,startTime:r[0]||n.startTime,endTime:r[1]||n.endTime,periodName:e.time.split("\n")[1]||n.periodName})}return(0,a.A)((0,a.A)({},e),{},{id:t+1})})))}catch(e){console.error("\u89e3\u6790\u8bfe\u7a0b\u8868\u6570\u636e\u5931\u8d25:",e),de()}else de()}catch(e){console.error("\u83b7\u53d6\u8bfe\u7a0b\u8868\u6570\u636e\u5931\u8d25:",e),de()}},de=()=>{const e=ne.map(((e,t)=>{const n={id:t+1,time:"".concat(e.startTime,"-").concat(e.endTime,"\n").concat(e.periodName),startTime:e.startTime,endTime:e.endTime,periodName:e.periodName};return te.forEach((e=>{n[e.value]=""})),n}));Y(e)},ce=()=>{X(null),ee(null)},he=(e,t)=>{$&&ee((0,a.A)((0,a.A)({},$),{},{[e]:t}))},me=[{title:"\u6559\u5e08\u603b\u6570",value:o.teacherCount,icon:(0,L.jsx)(z.A,{color:"primary",fontSize:"large"}),color:"primary.main"},{title:"\u5b66\u751f\u603b\u6570",value:o.studentCount,icon:(0,L.jsx)(k.A,{sx:{color:"#34c759"},fontSize:"large"}),color:"success.main"},{title:"\u73ed\u7ea7\u603b\u6570",value:o.classCount,icon:(0,L.jsx)(M.A,{sx:{color:"#ff9500"},fontSize:"large"}),color:"warning.main"}];return(0,r.useEffect)((()=>{se(),le()}),[]),(0,L.jsxs)(s.A,{children:[(0,L.jsx)(h.A,{variant:"h5",component:"h1",sx:{mb:3},children:"\u4eea\u8868\u76d8"}),(0,L.jsx)(m.Ay,{container:!0,spacing:3,sx:{marginBottom:4},children:me.map(((e,t)=>(0,L.jsx)(m.Ay,{item:!0,xs:12,sm:6,md:4,lg:4,children:(0,L.jsx)(P,{children:(0,L.jsx)(u.A,{children:(0,L.jsxs)(s.A,{sx:{display:"flex",alignItems:"center"},children:[(0,L.jsx)(s.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center",width:60,height:60,borderRadius:"50%",backgroundColor:"".concat(e.color,"15"),mr:2},children:e.icon}),(0,L.jsxs)(s.A,{children:[(0,L.jsx)(h.A,{variant:"body2",color:"text.secondary",children:e.title}),(0,L.jsx)(h.A,{variant:"h4",component:"div",sx:{fontWeight:600,mt:.5},children:e.value})]})]})})})},t)))}),(0,L.jsxs)(B,{children:[(0,L.jsxs)(H,{children:[(0,L.jsx)(h.A,{variant:"h6",children:"\u6211\u7684\u8bfe\u7a0b\u8868"}),(0,L.jsx)(p.A,{variant:"contained",color:"primary",startIcon:(0,L.jsx)(I.A,{}),onClick:()=>{q(JSON.parse(JSON.stringify(c))),F(!0)},children:"\u7f16\u8f91\u8bfe\u7a0b\u8868"})]}),(0,L.jsx)(u.A,{children:(0,L.jsx)(x.A,{children:(0,L.jsxs)(A.A,{children:[(0,L.jsx)(v.A,{children:(0,L.jsxs)(j.A,{children:[(0,L.jsx)(d.A,{width:"150px",children:"\u65f6\u95f4"}),te.map((e=>(0,L.jsx)(d.A,{children:e.label},e.value)))]})}),(0,L.jsx)(g.A,{children:c.map(((e,t)=>(0,L.jsxs)(j.A,{sx:{"&:nth-of-type(odd)":{backgroundColor:"rgba(0, 0, 0, 0.02)"}},children:[(0,L.jsxs)(D,{children:[e.time,(0,L.jsx)(f.A,{title:"\u7f16\u8f91\u65f6\u95f4",children:(0,L.jsx)(E,{size:"small",onClick:t=>((e,t)=>{X(e.currentTarget),ee((0,a.A)({},t))})(t,e),children:(0,L.jsx)(I.A,{fontSize:"small"})})})]}),te.map((t=>(0,L.jsx)(d.A,{children:e[t.value]},t.value)))]},t)))})]})})})]}),(0,L.jsxs)(y.A,{open:Z,onClose:()=>F(!1),maxWidth:"lg",fullWidth:!0,children:[(0,L.jsx)(C.A,{children:"\u7f16\u8f91\u8bfe\u7a0b\u8868"}),(0,L.jsxs)(b.A,{children:[(0,L.jsx)(h.A,{variant:"body2",sx:{mb:2},children:"\u8bf7\u5728\u5bf9\u5e94\u65f6\u95f4\u6bb5\u586b\u5199\u8bfe\u7a0b\u5185\u5bb9\uff0c\u7559\u7a7a\u8868\u793a\u6ca1\u6709\u8bfe\u7a0b"}),(0,L.jsx)(x.A,{children:(0,L.jsxs)(A.A,{children:[(0,L.jsx)(v.A,{children:(0,L.jsxs)(j.A,{children:[(0,L.jsx)(d.A,{width:"150px",children:"\u65f6\u95f4"}),te.map((e=>(0,L.jsx)(d.A,{children:e.label},e.value)))]})}),(0,L.jsx)(g.A,{children:_.map(((e,t)=>(0,L.jsxs)(j.A,{children:[(0,L.jsx)(d.A,{width:"150px",children:e.time}),te.map((n=>(0,L.jsx)(d.A,{children:(0,L.jsx)(U,{value:e[n.value]||"",onChange:e=>((e,t,n)=>{const a=[..._];a[e][t]=n,q(a)})(t,n.value,e.target.value),placeholder:"\u8bf7\u8f93\u5165\u8bfe\u7a0b",size:"small",fullWidth:!0})},n.value)))]},t)))})]})})]}),(0,L.jsxs)(w.A,{children:[(0,L.jsx)(p.A,{onClick:()=>F(!1),children:"\u53d6\u6d88"}),(0,L.jsx)(p.A,{onClick:async()=>{K(!0);const e=localStorage.getItem("token");if(!e||"undefined"===e||"null"===e)return oe("\u767b\u5f55\u5df2\u8fc7\u671f\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55","warning"),window.location.href="/login?redirect="+encodeURIComponent(window.location.pathname),void K(!1);try{await J(_),Y(JSON.parse(JSON.stringify(_))),F(!1),oe("\u8bfe\u7a0b\u8868\u4fdd\u5b58\u6210\u529f","success")}catch(o){var t,n,a,r;if(console.error("\u4fdd\u5b58\u8bfe\u7a0b\u8868\u5931\u8d25:",o),403===(null===(t=o.response)||void 0===t?void 0:t.status)||401===(null===(n=o.response)||void 0===n?void 0:n.status))oe("\u767b\u5f55\u5df2\u8fc7\u671f\u6216\u6743\u9650\u4e0d\u8db3\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55","warning"),window.location.href="/login?redirect="+encodeURIComponent(window.location.pathname);else oe("\u4fdd\u5b58\u8bfe\u7a0b\u8868\u5931\u8d25: "+((null===(a=o.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.message)||"\u8bf7\u7a0d\u540e\u91cd\u8bd5"),"error")}finally{K(!1)}},variant:"contained",color:"primary",disabled:G,startIcon:G?null:(0,L.jsx)(R.A,{}),children:G?"\u4fdd\u5b58\u4e2d...":"\u4fdd\u5b58"})]})]}),(0,L.jsx)(T.Ay,{open:Boolean(Q),anchorEl:Q,onClose:ce,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"},children:(0,L.jsxs)(s.A,{sx:{p:2,width:250},children:[(0,L.jsx)(h.A,{variant:"subtitle1",sx:{mb:2},children:"\u7f16\u8f91\u65f6\u95f4"}),(0,L.jsxs)(s.A,{sx:{mb:2},children:[(0,L.jsx)(h.A,{variant:"body2",sx:{mb:1},children:"\u5f00\u59cb\u65f6\u95f4"}),(0,L.jsx)(l.A,{type:"time",value:(null===$||void 0===$?void 0:$.startTime)||"",onChange:e=>he("startTime",e.target.value),size:"small",fullWidth:!0,InputLabelProps:{shrink:!0},inputProps:{step:300}})]}),(0,L.jsxs)(s.A,{sx:{mb:2},children:[(0,L.jsx)(h.A,{variant:"body2",sx:{mb:1},children:"\u7ed3\u675f\u65f6\u95f4"}),(0,L.jsx)(l.A,{type:"time",value:(null===$||void 0===$?void 0:$.endTime)||"",onChange:e=>he("endTime",e.target.value),size:"small",fullWidth:!0,InputLabelProps:{shrink:!0},inputProps:{step:300}})]}),(0,L.jsxs)(s.A,{sx:{mb:2},children:[(0,L.jsx)(h.A,{variant:"body2",sx:{mb:1},children:"\u8bfe\u65f6\u540d\u79f0"}),(0,L.jsx)(l.A,{value:(null===$||void 0===$?void 0:$.periodName)||"",onChange:e=>he("periodName",e.target.value),placeholder:"\u4f8b\u5982\uff1a\u7b2c\u4e00\u8282",size:"small",fullWidth:!0})]}),(0,L.jsxs)(s.A,{sx:{display:"flex",justifyContent:"flex-end"},children:[(0,L.jsx)(p.A,{onClick:ce,sx:{mr:1},children:"\u53d6\u6d88"}),(0,L.jsx)(p.A,{onClick:()=>{if($&&$.startTime&&$.endTime){const e=$.startTime,t=$.endTime,n=$.periodName||"",r=(0,a.A)((0,a.A)({},$),{},{startTime:e,endTime:t,time:"".concat(e,"-").concat(t,"\n").concat(n)}),o=c.map((e=>e.id===r.id?r:e));Y(o);const i=localStorage.getItem("token");if(!i||"undefined"===i||"null"===i)return oe("\u767b\u5f55\u5df2\u8fc7\u671f\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55","warning"),void(window.location.href="/login?redirect="+encodeURIComponent(window.location.pathname));J(o).then((()=>{oe("\u65f6\u95f4\u66f4\u65b0\u6210\u529f\u5e76\u5df2\u4fdd\u5b58","success")})).catch((e=>{var t,n,a,r;(console.error("\u4fdd\u5b58\u8bfe\u7a0b\u8868\u5931\u8d25:",e),403===(null===(t=e.response)||void 0===t?void 0:t.status)||401===(null===(n=e.response)||void 0===n?void 0:n.status))?(oe("\u767b\u5f55\u5df2\u8fc7\u671f\u6216\u6743\u9650\u4e0d\u8db3\uff0c\u8bf7\u91cd\u65b0\u767b\u5f55","warning"),window.location.href="/login?redirect="+encodeURIComponent(window.location.pathname)):oe("\u4fdd\u5b58\u5931\u8d25: "+((null===(a=e.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.message)||"\u8bf7\u7a0d\u540e\u91cd\u8bd5"),"error")})),ce()}},variant:"contained",color:"primary",children:"\u786e\u8ba4"})]})]})}),(0,L.jsx)(S.A,{open:ae.open,autoHideDuration:6e3,onClose:ie,anchorOrigin:{vertical:"top",horizontal:"center"},children:(0,L.jsx)(N.A,{onClose:ie,severity:ae.severity,sx:{width:"100%"},children:ae.message})})]})}},89685:(e,t,n)=>{n.d(t,{A:()=>o});var a=n(99992),r=n(70579);const o=(0,a.A)((0,r.jsx)("path",{d:"M5 13.18v4L12 21l7-3.82v-4L12 17zM12 3 1 9l11 6 9-4.91V17h2V9z"}),"School")},91244:(e,t,n)=>{n.d(t,{A:()=>v});var a=n(89379),r=n(80045),o=n(65043),i=n(58387),s=n(31807),l=n(58128),d=n(28301),c=n(94799),h=n(79857),m=n(86061);function u(e){return(0,m.Ay)("MuiCard",e)}(0,h.A)("MuiCard",["root"]);var p=n(70579);const x=["className","raised"],A=(0,l.Ay)(c.A,{name:"MuiCard",slot:"Root"})({overflow:"hidden"}),v=o.forwardRef((function(e,t){const n=(0,d.b)({props:e,name:"MuiCard"}),{className:o,raised:l=!1}=n,c=(0,r.A)(n,x),h=(0,a.A)((0,a.A)({},n),{},{raised:l}),m=(e=>{const{classes:t}=e;return(0,s.A)({root:["root"]},u,t)})(h);return(0,p.jsx)(A,(0,a.A)({className:(0,i.A)(m.root,o),elevation:l?8:void 0,ref:t,ownerState:h},c))}))}}]);
//# sourceMappingURL=997.199b27bf.chunk.js.map