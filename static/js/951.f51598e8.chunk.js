"use strict";(self.webpackChunkfrontend_react=self.webpackChunkfrontend_react||[]).push([[951],{62898:(e,r,o)=>{function t(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:300,o=null;return function(){for(var t=arguments.length,n=new Array(t),a=0;a<t;a++)n[a]=arguments[a];const s=this;o&&clearTimeout(o),o=setTimeout((()=>{e.apply(s,n)}),r)}}o.d(r,{sg:()=>t})},65642:(e,r,o)=>{o.d(r,{A:()=>b});var t=o(89379),n=o(80045),a=o(65043),s=o(58128),i=o(24343),l=o(33699),d=o(42579),c=o(90160),p=o(97250),x=o(4573),u=o(23241),m=o(63745),h=o(22632),g=o(3665),f=o(70579);const w=["prefixIcon","showPassword","onEnter","onChange"],A=(0,s.Ay)(i.A)((e=>{let{theme:r}=e;return{"& .MuiOutlinedInput-root":{borderRadius:"12px",transition:"all 0.3s",backgroundColor:"rgba(255, 255, 255, 0.9)","&:hover":{backgroundColor:"#fff"},"&.Mui-focused":{backgroundColor:"#fff",boxShadow:"0 0 0 2px rgba(0, 113, 227, 0.2)"}},"& .MuiOutlinedInput-notchedOutline":{borderColor:"rgba(0, 0, 0, 0.1)"},"& .MuiOutlinedInput-input":{padding:"14px 16px"},"& .MuiInputLabel-outlined":{transform:"translate(16px, 15px) scale(1)"},"& .MuiInputLabel-outlined.MuiInputLabel-shrink":{transform:"translate(16px, -6px) scale(0.75)"}}})),y={person:(0,f.jsx)(c.A,{}),lock:(0,f.jsx)(p.A,{}),email:(0,f.jsx)(x.A,{}),phone:(0,f.jsx)(u.A,{}),search:(0,f.jsx)(m.A,{})},b=(0,a.forwardRef)(((e,r)=>{var o,s;let{prefixIcon:i,showPassword:c,onEnter:p,onChange:x}=e,u=(0,n.A)(e,w);const[m,b]=(0,a.useState)(!1);return(0,f.jsx)(A,(0,t.A)((0,t.A)({ref:r,variant:"outlined",fullWidth:!0},u),{},{type:"password"===u.type?m?"text":"password":u.type,onKeyDown:e=>{"Enter"===e.key&&p&&p(),u.onKeyDown&&u.onKeyDown(e)},onChange:e=>{x&&x(e)},InputProps:(0,t.A)((0,t.A)({},u.InputProps),{},{startAdornment:i?(0,f.jsx)(l.A,{position:"start",children:i&&y[i]||null}):null===(o=u.InputProps)||void 0===o?void 0:o.startAdornment,endAdornment:"password"===u.type&&c?(0,f.jsx)(l.A,{position:"end",children:(0,f.jsx)(d.A,{"aria-label":"toggle password visibility",onClick:()=>{b(!m)},edge:"end",size:"large",children:m?(0,f.jsx)(h.A,{}):(0,f.jsx)(g.A,{})})}):null===(s=u.InputProps)||void 0===s?void 0:s.endAdornment})}))}))},75951:(e,r,o)=>{o.r(r),o.d(r,{default:()=>T});var t=o(89379),n=o(65043),a=o(3260),s=o(79722),i=o(88363),l=o(58128),d=o(91449),c=o(53969),p=o(94799),x=o(55895),u=o(70298),m=o(12097),h=o(65642),g=o(94703),f=o(62898),w=o(70579);const A=()=>(0,w.jsx)(i.A,{styles:{"@keyframes fadeIn":{"0%":{opacity:0,transform:"translateY(-10px)"},"100%":{opacity:1,transform:"translateY(0)"}},"@keyframes slideIn":{"0%":{opacity:0,transform:"translateX(-10px)"},"100%":{opacity:1,transform:"translateX(0)"}},"@keyframes pulse":{"0%":{boxShadow:"0 0 0 0 rgba(76, 175, 80, 0.4)"},"70%":{boxShadow:"0 0 0 10px rgba(76, 175, 80, 0)"},"100%":{boxShadow:"0 0 0 0 rgba(76, 175, 80, 0)"}},"@keyframes bounce":{"0%, 20%, 50%, 80%, 100%":{transform:"translateY(0)"},"40%":{transform:"translateY(-10px)"},"60%":{transform:"translateY(-5px)"}}}}),y=(0,l.Ay)(d.A)((e=>{let{theme:r,severity:o}=e;return{borderRadius:"8px",padding:"10px 16px",fontSize:"14px",fontWeight:500,display:"flex",alignItems:"center",boxShadow:"0 2px 10px rgba(0, 0, 0, 0.08)",border:"1px solid",borderColor:"success"===o?r.palette.success.light:"error"===o?r.palette.error.light:r.palette.warning.light,"& .MuiAlert-icon":{fontSize:"20px",opacity:.9,marginRight:"12px"},"& .MuiAlert-message":{padding:"4px 0"}}})),b=(0,l.Ay)(y)((e=>{let{theme:r}=e;return{backgroundColor:"rgba(237, 247, 237, 0.9)",borderColor:r.palette.success.main,boxShadow:"0 4px 12px rgba(76, 175, 80, 0.15)",padding:"16px","& .MuiAlert-icon":{fontSize:"24px",color:r.palette.success.main},"& .MuiAlert-message":{fontSize:"15px",fontWeight:600}}})),v=(0,l.Ay)(c.A)((e=>{let{theme:r}=e;return{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"100vh",width:"100%",position:"relative",overflow:"hidden",padding:"40px 0",boxSizing:"border-box"}})),j=(0,l.Ay)(c.A)((e=>{let{theme:r}=e;return{display:"flex",flexDirection:"column",alignItems:"center",width:"100%",maxWidth:"460px",zIndex:1}})),S=(0,l.Ay)(p.A)((e=>{let{theme:r}=e;return{width:"100%",padding:"40px",borderRadius:"20px",boxShadow:"0 10px 30px rgba(0, 0, 0, 0.1)",overflow:"hidden",border:"1px solid rgba(255, 255, 255, 0.5)",margin:"20px 0"}})),I=(0,l.Ay)(c.A)((e=>{let{theme:r}=e;return{display:"flex",justifyContent:"center",marginBottom:"20px"}})),P=(0,l.Ay)(c.A)((e=>{let{theme:r}=e;return{display:"flex",alignItems:"center",justifyContent:"center",width:"80px",height:"80px",borderRadius:"50%",background:"white",boxShadow:"0 8px 16px rgba(0, 113, 227, 0.3)",marginBottom:"15px",overflow:"hidden"}})),C=(0,l.Ay)(c.A)((e=>{let{theme:r}=e;return{display:"flex",flexDirection:"column",gap:"15px",marginTop:"30px",width:"100%"}})),k=(0,l.Ay)(a.N_)((e=>{let{theme:r}=e;return{color:r.palette.primary.main,textDecoration:"none",fontSize:"14px",transition:"color 0.3s",textAlign:"center",display:"block",marginTop:r.spacing(2),"&:hover":{color:r.palette.primary.light,textDecoration:"underline"}}})),W=(0,l.Ay)(c.A)((e=>{let{theme:r}=e;return{marginTop:"20px",color:"#5d6280",textAlign:"center",fontSize:"14px",fontWeight:600,textShadow:"0 1px 1px rgba(255, 255, 255, 0.5)"}})),T=()=>{const e=(0,n.useRef)(!1),[r,o]=(0,n.useState)({username:"",email:"",code:"",newPassword:"",confirmPassword:""}),[i,l]=(0,n.useState)(!1),[d,p]=(0,n.useState)(""),[T,D]=(0,n.useState)("error"),[R,_]=(0,n.useState)(!1),[E,z]=(0,n.useState)(!1),[M,B]=(0,n.useState)(0),[O,L]=(0,n.useState)(!1),[q,K]=(0,n.useState)(!1),[Y,H]=(0,n.useState)(3);(0,n.useEffect)((()=>{const r=r=>{e.current||(r.preventDefault(),r.returnValue="")};return window.addEventListener("beforeunload",r),()=>{window.removeEventListener("beforeunload",r)}}),[]);const N=e=>{const{name:r,value:n}=e.target;o((e=>(0,t.A)((0,t.A)({},e),{},{[r]:n}))),"username"!==r&&"email"!==r||L(!1)},U=async()=>{if(!r.username.trim()||!r.email.trim())return!1;try{return(await(0,g.Kq)({username:r.username,email:r.email})).success?(L(!0),!0):(L(!1),D("error"),p("\u7528\u6237\u540d\u4e0e\u90ae\u7bb1\u4e0d\u5339\u914d\uff0c\u8bf7\u68c0\u67e5\u8f93\u5165"),!1)}catch(e){return console.error("\u9a8c\u8bc1\u7528\u6237\u540d\u548c\u90ae\u7bb1\u51fa\u9519:",e),L(!1),D("error"),p("\u9a8c\u8bc1\u7528\u6237\u540d\u548c\u90ae\u7bb1\u65f6\u51fa\u73b0\u9519\u8bef"),!1}},F=(0,f.sg)((async r=>{if(!R){_(!0),l(!0),p("");try{console.log("\u51c6\u5907\u53d1\u9001\u91cd\u7f6e\u5bc6\u7801\u8bf7\u6c42:",{username:r.username,email:r.email,code:r.code,newPassword:"***"});const t=await(0,g.WU)({username:r.username,email:r.email,code:r.code,newPassword:r.newPassword});console.log("\u91cd\u7f6e\u5bc6\u7801\u8bf7\u6c42\u6210\u529f:",t),D("success"),p("\u5bc6\u7801\u91cd\u7f6e\u6210\u529f\uff0c\u8bf7\u4f7f\u7528\u65b0\u5bc6\u7801\u767b\u5f55"),K(!0),o({username:"",email:"",code:"",newPassword:"",confirmPassword:""}),window.scrollTo({top:0,behavior:"smooth"}),H(3);const n=setInterval((()=>{H((r=>r<=1?(clearInterval(n),e.current=!0,window.location.href="/login",0):r-1))}),1e3)}catch(t){console.error("\u91cd\u7f6e\u5bc6\u7801\u8bf7\u6c42\u5931\u8d25:",t),D("error"),K(!1),t.response?(console.error("\u9519\u8bef\u54cd\u5e94\u6570\u636e:",t.response.data),console.error("\u9519\u8bef\u72b6\u6001\u7801:",t.response.status),p(t.response.data&&t.response.data.message||"\u91cd\u7f6e\u5bc6\u7801\u5931\u8d25")):t.request?(console.error("\u8bf7\u6c42\u5df2\u53d1\u9001\u4f46\u672a\u6536\u5230\u54cd\u5e94"),p("\u65e0\u6cd5\u8fde\u63a5\u5230\u670d\u52a1\u5668\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc")):(console.error("\u8bf7\u6c42\u8bbe\u7f6e\u65f6\u51fa\u9519:",t.message),p("\u91cd\u7f6e\u5bc6\u7801\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u9519\u8bef: "+t.message)),window.scrollTo({top:0,behavior:"smooth"})}finally{l(!1),setTimeout((()=>{_(!1)}),1e3)}}}),0);return(0,w.jsxs)(v,{children:[(0,w.jsx)(A,{}),(0,w.jsxs)(j,{children:[(0,w.jsxs)(S,{children:[(0,w.jsxs)(c.A,{sx:{textAlign:"center",marginBottom:"30px"},children:[(0,w.jsx)(I,{children:(0,w.jsx)(P,{children:(0,w.jsx)("img",{src:"https://img.icons8.com/color/96/000000/school.png",alt:"\u5b66\u6821Logo",style:{width:"90%",height:"90%",objectFit:"contain"}})})}),(0,w.jsx)(x.A,{variant:"h4",sx:{margin:"0 0 10px 0",fontWeight:600,letterSpacing:"-0.5px"},children:"\u91cd\u7f6e\u5bc6\u7801"}),(0,w.jsx)(x.A,{variant:"body1",color:"text.secondary",sx:{margin:"0 0 20px 0"},children:"\u8bf7\u586b\u5199\u4ee5\u4e0b\u4fe1\u606f\u91cd\u7f6e\u60a8\u7684\u5bc6\u7801"})]}),d&&(0,w.jsx)(c.A,{sx:{marginBottom:"20px",animation:q?"fadeIn 0.8s ease-in-out":"fadeIn 0.5s ease-in-out",transition:"all 0.3s ease"},children:q?(0,w.jsx)(b,{severity:"success",sx:{animation:"slideIn 0.5s ease-in-out forwards, pulse 2s infinite ease-in-out",position:"relative"},children:(0,w.jsxs)(c.A,{children:[d,(0,w.jsxs)(x.A,{variant:"body2",sx:{marginTop:"8px",fontWeight:500,animation:"bounce 1s infinite"},children:[Y,"\u79d2\u540e\u81ea\u52a8\u8df3\u8f6c\u5230\u767b\u5f55\u9875\u9762..."]})]})}):(0,w.jsx)(y,{severity:T,sx:{animation:"slideIn 0.3s ease-in-out forwards",position:"relative"},children:d})}),!q&&(0,w.jsxs)(c.A,{component:"form",sx:{width:"100%"},onSubmit:e=>(e.preventDefault(),!1),noValidate:!0,children:[(0,w.jsx)(c.A,{sx:{marginBottom:"16px"},children:(0,w.jsx)(h.A,{name:"username",value:r.username,onChange:N,placeholder:"\u7528\u6237\u540d",prefixIcon:"person",fullWidth:!0,required:!0})}),(0,w.jsx)(c.A,{sx:{marginBottom:"16px"},children:(0,w.jsx)(h.A,{name:"email",value:r.email,onChange:N,placeholder:"\u90ae\u7bb1",prefixIcon:"email",type:"email",fullWidth:!0,required:!0})}),(0,w.jsx)(c.A,{sx:{marginBottom:"16px"},children:(0,w.jsxs)(u.A,{direction:"row",spacing:1,children:[(0,w.jsx)(c.A,{sx:{flex:"1 1 65%"},children:(0,w.jsx)(h.A,{name:"code",value:r.code,onChange:N,placeholder:"\u9a8c\u8bc1\u7801",prefixIcon:"key",fullWidth:!0,required:!0})}),(0,w.jsx)(c.A,{sx:{flex:"1 1 35%"},children:(0,w.jsx)(m.A,{variant:"contained",color:"primary",onClick:async e=>{var o,t;if(e&&e.preventDefault&&e.preventDefault(),e&&e.stopPropagation&&e.stopPropagation(),E||M>0)return console.log("\u6309\u94ae\u5df2\u7981\u7528\u6216\u5012\u8ba1\u65f6\u4e2d"),!1;if(null===(o=r.username)||void 0===o||!o.trim())return D("error"),p("\u8bf7\u8f93\u5165\u7528\u6237\u540d"),!1;if(null===(t=r.email)||void 0===t||!t.trim())return D("error"),p("\u8bf7\u8f93\u5165\u90ae\u7bb1"),!1;if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.email))return D("error"),p("\u8bf7\u8f93\u5165\u6709\u6548\u7684\u90ae\u7bb1\u5730\u5740"),!1;if(!await U())return!1;z(!0),p("");try{console.log("\u5f00\u59cb\u53d1\u9001\u9a8c\u8bc1\u7801...");const e=await(async e=>{try{console.log("\u53d1\u9001\u9a8c\u8bc1\u7801\u8bf7\u6c42...");const r={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_API_URL||"http://124.70.74.246:8081",o=await s.A.post("".concat(r,"/api/auth/send-verification-code"),{email:e});return console.log("\u9a8c\u8bc1\u7801\u53d1\u9001\u6210\u529f\u54cd\u5e94:",o),{success:!0,data:o.data}}catch(r){return console.error("\u53d1\u9001\u9a8c\u8bc1\u7801\u5931\u8d25:",r),{success:!1,error:r}}})(r.email);if(e.success){console.log("\u9a8c\u8bc1\u7801\u53d1\u9001\u6210\u529f"),D("success"),p("\u9a8c\u8bc1\u7801\u5df2\u53d1\u9001\u5230\u60a8\u7684\u90ae\u7bb1\uff0c\u8bf7\u67e5\u6536"),B(60);const e=setInterval((()=>{B((r=>r<=1?(clearInterval(e),0):r-1))}),1e3)}else console.log("\u9a8c\u8bc1\u7801\u53d1\u9001\u5931\u8d25",e.error),D("error"),p("\u53d1\u9001\u9a8c\u8bc1\u7801\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5")}catch(n){console.error("\u53d1\u9001\u9a8c\u8bc1\u7801\u8fc7\u7a0b\u4e2d\u51fa\u9519:",n),D("error"),p("\u53d1\u9001\u9a8c\u8bc1\u7801\u8fc7\u7a0b\u4e2d\u51fa\u73b0\u9519\u8bef\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5")}finally{z(!1)}return!1},type:"button",disabled:E||M>0,sx:{height:"50px",borderRadius:"12px",width:"100%",boxShadow:"none",fontSize:"14px",fontWeight:500,whiteSpace:"nowrap",padding:"0 8px",minWidth:"100px","&:hover":{boxShadow:"0 3px 5px rgba(0, 113, 227, 0.3)"},"&.Mui-disabled":{backgroundColor:"rgba(0, 113, 227, 0.12)",color:"rgba(0, 113, 227, 0.5)"}},children:M>0?"".concat(M,"\u79d2"):"\u83b7\u53d6\u9a8c\u8bc1\u7801"})})]})}),(0,w.jsx)(c.A,{sx:{marginBottom:"16px"},children:(0,w.jsx)(h.A,{name:"newPassword",value:r.newPassword,onChange:N,placeholder:"\u65b0\u5bc6\u7801",prefixIcon:"lock",type:"password",fullWidth:!0,required:!0})}),(0,w.jsx)(c.A,{sx:{marginBottom:"16px"},children:(0,w.jsx)(h.A,{name:"confirmPassword",value:r.confirmPassword,onChange:N,placeholder:"\u786e\u8ba4\u65b0\u5bc6\u7801",prefixIcon:"lock",type:"password",fullWidth:!0,required:!0})}),(0,w.jsxs)(C,{children:[(0,w.jsx)(m.A,{variant:"contained",color:"primary",onClick:async e=>{if(e.preventDefault(),e.stopPropagation(),i||R)return;if(!r.username.trim())return D("error"),void p("\u8bf7\u8f93\u5165\u7528\u6237\u540d");if(!r.email.trim())return D("error"),void p("\u8bf7\u8f93\u5165\u90ae\u7bb1");if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.email))return D("error"),void p("\u8bf7\u8f93\u5165\u6709\u6548\u7684\u90ae\u7bb1\u5730\u5740");if(!O){if(!await U())return}return r.code.trim()?r.newPassword.trim()?r.newPassword.length<6?(D("error"),void p("\u5bc6\u7801\u957f\u5ea6\u4e0d\u80fd\u5c11\u4e8e6\u4e2a\u5b57\u7b26")):r.newPassword!==r.confirmPassword?(D("error"),void p("\u4e24\u6b21\u8f93\u5165\u7684\u5bc6\u7801\u4e0d\u4e00\u81f4")):(F(r),!1):(D("error"),void p("\u8bf7\u8f93\u5165\u65b0\u5bc6\u7801")):(D("error"),void p("\u8bf7\u8f93\u5165\u9a8c\u8bc1\u7801"))},type:"button",disabled:i,sx:{height:"50px",borderRadius:"12px",fontSize:"16px",fontWeight:500},children:i?"\u91cd\u7f6e\u4e2d...":"\u91cd\u7f6e\u5bc6\u7801"}),(0,w.jsx)(k,{to:"/login",children:"\u8fd4\u56de\u767b\u5f55"})]})]}),q&&(0,w.jsx)(c.A,{sx:{textAlign:"center",marginTop:"20px"},children:(0,w.jsx)(m.A,{variant:"outlined",color:"primary",component:a.N_,to:"/login",sx:{height:"50px",borderRadius:"12px",fontSize:"16px",fontWeight:500,width:"100%",marginTop:"20px"},children:"\u7acb\u5373\u8fd4\u56de\u767b\u5f55"})})]}),(0,w.jsx)(W,{children:(0,w.jsx)(x.A,{variant:"body2",children:"\xa9 2025 \u73ed\u4e3b\u4efb\u7ba1\u7406\u7cfb\u7edf - \u9ad8\u6548\u7684\u6559\u80b2\u7ba1\u7406\u5e73\u53f0"})})]})]})}}}]);
//# sourceMappingURL=951.f51598e8.chunk.js.map